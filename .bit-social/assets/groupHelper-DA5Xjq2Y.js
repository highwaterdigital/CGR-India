import{a2 as M,$ as O,ag as W,z as x,G as Te,x as oe,y as X,B as l,T as m,au as R,D as i,j as a,F as ee,S,E as y,a4 as Ue,H as Q,r as I,Q as se,O as q,J as ke,K as ie,c7 as he,an as K,c8 as Re,N as te,a3 as _,s as Y,I as ve,M as Se,L as Fe,c9 as ue,A as je,ca as Ne,P as de}from"./main-dark-cougars-deny.js";import{p as ne,i as ae}from"./platforms-D2zu1ywB.js";import{P as ce}from"./PlatformIcon-BT0ubZly.js";import{C as J}from"./index-lmO9dkKN.js";import{R as Z,C as b}from"./row-lqfnAFmz.js";import{A as Le}from"./index-Bt9HWWmk.js";import{F as D}from"./index-k0aiACIX.js";import{A as Me}from"./index-SKRzeqqf.js";import{s as F}from"./index-Bs04ZD0k.js";import{P as $e,F as g}from"./index-CPtrnYXw.js";import{I as P}from"./index-DWSuPlFC.js";import{S as _e}from"./index-DBPaF3NB.js";globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};function qe({searchAccountsTxt:e="",selectedMenuTab:t={}}={}){const{isModalOpen:o}=M(O),c=[];e&&c.push(e),t.type&&c.push(t);const{data:s,isFetching:h,isLoading:u,refetch:n}=W({queryFn:async()=>x("accounts",void 0,{search:e,...t},"GET"),queryKey:["accounts",...c],refetchInterval:o?2e3:!1});return{accounts:(s==null?void 0:s.data)||[],isFetchingAccounts:h,isLoadingAccounts:u,refetchAccounts:n}}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};function Oe(){const[e]=Te({}),t=e.get("value")||"",c={type:e.get("type")||"",value:t},s=oe(),{isError:h,isPending:u,isSuccess:n,mutateAsync:r}=X({mutationFn:async d=>x("account/save",{accountData:d},void 0,"POST"),mutationKey:["save_account"],onSuccess:()=>{s.invalidateQueries({queryKey:["active-accounts"]}),s.invalidateQueries({queryKey:["accounts",c]})}});return{isSavingAccount:u,isSavingAccountError:h,isSavingAccountSuccess:n,saveAccount:r}}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};function Be(){const{isPending:e,mutateAsync:t}=X({mutationFn:async o=>x(o.url,o.data,void 0,"POST")});return{isVerifyAccountLoading:e,verifyAccount:o=>t(o)}}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const Ve=e=>{switch(e){case"googleBusinessProfile":return l(ee,{children:[i("You can only add verified locations."),a("br",{}),i("If you need to add another Google account, simply log out of or switch Google accounts first.")]});default:return a(ee,{children:R(i("If you need to add another %s  account, simply log out of or switch %s accounts first."),e,e)})}};function Ee({count:e=0,platform:t}){return l(m.Text,{style:{fontSize:"14px"},type:"secondary",children:[l("div",{children:[R(i("Total %s accounts found"),e)," "]}),Ve(t)]})}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const De=({token:e})=>({background:`${e.colorBgLayout} `});function pe({accountType:e,connectAccountId:t,handleConnect:o,icon:c,id:s,isConnected:h,isLoading:u,name:n}){const r=JSON.parse(e).account_type;return a(J,{css:De,size:"small",children:l(Z,{align:"middle",justify:"space-between",children:[a(b,{children:l(S,{size:"small",children:[a(Le,{size:40,src:c}),l(D,{style:{maxWidth:"300px"},vertical:!0,children:[a(m.Text,{ellipsis:!0,strong:!0,title:n,children:n}),a(m.Text,{type:"secondary",children:r})]})]})}),a(b,{children:h?a(m.Text,{className:"mx-2",type:"success",children:i("Saved")}):a(y,{disabled:u&&s!==t,loading:u&&s===t,onClick:o,type:"primary",children:i("Save")})})]})})}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};function Ke(){var E;const[e,t]=Ue(O),{isProClient:o}=Q(ie),{isSavingAccount:c,saveAccount:s}=Oe(),{isVerifyAccountLoading:h,verifyAccount:u}=Be(),[n,r]=I.useState(),d=()=>{t(he)},f=I.useMemo(()=>Array.isArray(e==null?void 0:e.details)?e.details.map(p=>{const{details:A}=p.account,{account_id:T,account_name:L,icon:z}=JSON.parse(A);return{accountDetails:p.account,accountIcon:z,accountId:T,accountName:L,isConnected:p.isConnected,verifyUrl:p.verifyUrl}}):[],[e==null?void 0:e.details]),C=async(p,A)=>{var z;r(p.account_id);let T={...p};if(A){const w=await u({data:T,url:A});if(w.status==="error")return r(void 0),F.error({description:w.data.message,message:"Account Save Failed"});T=w.data.accountDetails}const L=await s(T);if(r(void 0),L.status==="error")return F.error({description:L.data.message,message:"Account Save Failed"});if(L.status==="success"){const N=(z=e==null?void 0:e.details)==null?void 0:z.map(w=>{const G=w.account.account_id;return String(G)===String(L.data.account.account_id)?{...w,isConnected:!0}:w});t(w=>({...w,details:N})),F.success({message:"Account Save Successfully"})}},j=e.platform&&ne[e.platform].name;return I.useEffect(()=>{function p(A){A.preventDefault(),t(he)}return window.addEventListener("beforeunload",p,{capture:!0}),()=>{window.removeEventListener("beforeunload",p,{capture:!0})}},[]),l(se,{footer:!1,maskClosable:!1,onCancel:d,open:e.isModalOpen,styles:{body:{maxHeight:"70vh",overflowY:"scroll",padding:"0 8px"}},title:e.loading?l(S,{children:[a(q.Avatar,{active:!0,shape:"circle",size:"large"}),a(q.Input,{active:!0,size:"small"})]}):l(D,{align:"center",gap:"small",children:[a(ce,{name:e.platform,size:30}),a(m.Text,{style:{fontSize:"18px",textTransform:"capitalize"},children:j})]}),children:[l(S,{className:"w-100 py-2",direction:"vertical",children:[e.loading&&!e.status?Array.from({length:3}).fill(0).map((p,A)=>a(J,{className:"w-100",size:"small",children:l(S,{className:"w-100",size:"large",children:[a(q.Avatar,{active:!0,shape:"circle",size:"large"}),a(q.Input,{active:!0,block:!0,size:"small",style:{width:"260px"}}),a(q.Button,{active:!0})]})},`key-${A+9}`)):(j==="LinkedIn"&&!o?l(D,{gap:10,vertical:!0,children:[a(m.Title,{level:5,children:i("Profile")}),f&&f.length&&f.map(p=>a(pe,{accountType:p.accountDetails.details,connectAccountId:n,handleConnect:()=>C(p.accountDetails,p.verifyUrl),icon:p.accountIcon,id:p.accountId,isConnected:p.isConnected,isLoading:c||h,name:p.accountName},p.accountId)),l(m.Title,{level:5,children:[i("Page")," ",a(ke,{color:"#ff8609",size:20})]}),a(J,{className:"w-100",size:"small",children:l(S,{className:"w-100",size:"large",children:[a(q.Avatar,{shape:"circle",size:"large"}),a(q.Input,{block:!0,size:"small",style:{width:"260px"}}),a(q.Button,{})]})}),a(m.Text,{strong:!0,children:i("Linkedin Page feature on pro")})]}):f&&f.length&&f.map(p=>a(pe,{accountType:p.accountDetails.details,connectAccountId:n,handleConnect:()=>C(p.accountDetails,p.verifyUrl),icon:p.accountIcon,id:p.accountId,isConnected:p.isConnected,isLoading:c||h,name:p.accountName},p.accountId)))||"",e.status==="success"&&!((E=e.details)!=null&&E.length)&&a(m.Title,{level:5,children:j==="Pinterest"?i("Board Not Found"):i("Account Not Found")}),e.status==="error"&&l(D,{vertical:!0,children:[l(m.Title,{level:5,children:[" ",i("Account connect failed")]}),a(Me,{description:e.message,type:"error"})]})]}),e.status&&j?a(Ee,{count:f==null?void 0:f.length,platform:j}):a(m.Title,{level:5,children:"Fetching data, please wait..."})]})}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};function Ge(){const{data:e,isFetching:t,isLoading:o,refetch:c}=W({queryFn:async()=>x("platforms-credentials",void 0,void 0,"POST"),queryKey:["clientIds"]}),{clientInfo:s}=(e==null?void 0:e.data)||{};return{clientIds:s,isFetchingClientIds:t,isLoadingClientIds:o,refetchClientIds:c}}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const ge={bluesky:"https://bit-social.com/documentation/accounts/connect-your-bluesky-account-with-bit-social/",discord:"https://bit-social.com/docs/accounts/connect-your-discord-account-with-bit-social/",facebook:"https://bit-social.com/documentation/accounts/connect-your-facebook-account-with-bit-social/",googleBusinessProfile:"https://bit-social.com/documentation/accounts/connect-your-google-business-profile-account-with-bit-social/",instagram:"https://bit-social.com/documentation/accounts/connect-your-instagram-account-with-bit-social/",line:"https://bit-social.com/documentation/accounts/connect-your-line-account-with-bit-social/",linkedin:"https://bit-social.com/documentation/accounts/connect-your-linkedin-account-with-bit-social/",pinterest:"https://bit-social.com/docs/accounts/connect-your-pinterest-account-with-bit-social/",telegram:"https://bit-social.com/documentation/accounts/connect-your-telegram-account-with-bit-social/",threads:"https://bit-social.com/documentation/accounts/connect-your-threads-account-with-bit-social/",tiktok:"https://bit-social.com/documentation/accounts/connect-your-tiktok-account-with-bit-social/",tumblr:"https://bit-social.com/documentation/accounts/connect-your-tumblr-account-with-bit-social/",twitter:"https://bit-social.com/documentation/accounts/connect-your-twitter-account-with-bit-social/"};function He(e){if(!e||!ge[e]){console.error("Invalid link key",e);return}const t=new URL(ge[e]);return t.searchParams.append("utm_source",K.PLUGIN_SLUG),t.searchParams.append("utm_medium","inside-plugin"),t.href}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};function me({platform:e}){return a(y,{href:He(e),icon:a(Re,{}),rel:"noopener noreferrer nofollow",size:"small",style:{whiteSpace:"nowrap"},target:"_blank",type:"link",children:i("Doc Link")})}const Ye="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20height='512'%20width='512'%20xmlns:v='https://vecta.io/nano'%3e%3cpath%20d='M501.301%20131.964c-5.888-22.172-23.237-39.633-45.266-45.56C416.107%2075.636%20256%2075.636%20256%2075.636s-160.107%200-200.035%2010.768c-22.029%205.926-39.378%2023.388-45.266%2045.56C0%20172.152%200%20256%200%20256s0%2083.848%2010.699%20124.036c5.888%2022.172%2023.237%2039.633%2045.266%2045.56C95.893%20436.364%20256%20436.364%20256%20436.364s160.107%200%20200.035-10.768c22.029-5.927%2039.378-23.388%2045.266-45.56C512%20339.848%20512%20256%20512%20256s0-83.848-10.699-124.036z'%20fill='red'/%3e%3cpath%20d='m203.636%20332.128%20133.818-76.126-133.818-76.13z'%20fill='%23fff'/%3e%3c/svg%3e";globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const{Link:Qe}=m,fe={bluesky:"https://www.youtube.com/watch?v=2ftNPVnAISI",discord:"https://www.youtube.com/watch?v=q85NrjFQ33Y",facebook:"https://www.youtube.com/watch?v=V7-DqQ4dJg4",googleBusinessProfile:"https://www.youtube.com/watch?v=o3Hf2v4HsVs",instagram:"https://youtu.be/m44aFan4Nr4?si=Ro51TteqKr8kpnNq",line:"https://youtu.be/V_FyW_pK7ec?si=jgUU1NBiI3W9hplv",linkedin:"https://www.youtube.com/watch?v=YcmVEq3GGsk",pinterest:"https://www.youtube.com/watch?v=6deQqqhMYLY",threads:"https://youtu.be/VZUxncswKfw?si=y1YkjxWAin4iHETN",tiktok:"https://www.youtube.com/watch?v=5w5c0kY2tno",tumblr:"https://www.youtube.com/watch?v=WfxpNBBAjRQ",twitter:"https://www.youtube.com/watch?v=v2m99Itn-KU"};function Ce({platform:e}){if(!(!e||!fe[e]))return a(Qe,{href:fe[e],rel:"noopener noreferrer nofollow",strong:!0,style:{whiteSpace:"nowrap"},target:"_blank",children:a(y,{icon:a(Le,{alt:"youtube",size:20,src:Ye}),size:"small",type:"text",children:i("Tutorial")})})}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const{Link:Je}=m;function U({devLink:e,name:t}){return l(ee,{children:[i("To get app credentials, Visit")," ",l(Je,{href:e,rel:"noopener noreferrer nofollow",strong:!0,style:{whiteSpace:"nowrap"},target:"_blank",children:[ne[t].name," ",i("Developer"),a(te,{size:12,style:{transform:"translateY(-2px)"}})]})]})}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const{Text:We}=m,Xe=e=>{switch(e){case"discord":return a(U,{devLink:"https://discord.com/developers/applications/",name:e});case"facebook":return a(U,{devLink:"https://developers.facebook.com/apps/",name:e});case"googleBusinessProfile":return a(U,{devLink:"https://console.cloud.google.com/",name:e});case"instagram":return a(U,{devLink:"https://developers.facebook.com/apps/",name:e});case"linkedin":return a(U,{devLink:"https://www.linkedin.com/developers/apps",name:e});case"pinterest":return a(U,{devLink:"https://developers.pinterest.com/apps/",name:e});case"tiktok":return a(U,{devLink:"https://developers.tiktok.com",name:e});case"tumblr":return a(U,{devLink:"https://www.tumblr.com/oauth/apps",name:e});case"twitter":return a(U,{devLink:"https://developer.twitter.com/en/portal/dashboard",name:e});default:return""}};function Ze({platform:e}){return a(We,{children:Xe(e)})}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};function et(){const e=oe(),{isPending:t,mutateAsync:o}=X({mutationFn:async c=>x("custom-app",{...c},void 0,"POST"),mutationKey:["custom_app"],onSuccess:()=>{e.invalidateQueries({queryKey:["get-customApp"]})}});return{createCustomApp:c=>o(c),isLoadingCreateCustomApp:t}}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};function tt(e){const{data:t,isLoading:o,refetch:c}=W({queryFn:async()=>x("custom-app",void 0,{platform:e},"GET"),queryKey:["get-customApp"],refetchOnWindowFocus:!1});return{customApps:t==null?void 0:t.data,isLoadingCustomApp:o,refetchCustomApp:c}}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};function at(){const e=oe(),{isPending:t,mutateAsync:o}=X({mutationFn:async c=>x(`custom-app/${c}/destroy`,void 0,void 0,"POST"),onSuccess:()=>{e.invalidateQueries({queryKey:["get-customApp"]})}});return{deleteCustomApp:c=>o(c),isLoadingDeleteCustomApp:t}}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const xe=(e,t,o,c,s,h,u)=>{const[n,r]=[700,700],d=Math.round((window.innerWidth-n)/2),f=Math.round((window.innerHeight-r)/2),C=window.open(e,t,`width=${n},height=${r},left=${d},top=${f},toolbar=off`),j=setInterval(()=>{localStorage.setItem("__bitSocial_platform_interval",String(j)),!(!(C!=null&&C.closed)||C!=null&&C.closed&&!localStorage.getItem("__bitSocial_platform"))&&(clearInterval(j),o==null||o(),u(c,s,h))},500)};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const ct=`${K.CLIENT_SECRET_URL}`,{baseAuthStateURL:ot}=M(_),st=async e=>{const t={client_id:e.appId,platform:"facebook"},o={body:JSON.stringify(t),headers:{"Content-Type":"application/json"},method:"POST"};return fetch(ct,o).then(c=>c.json())},it=async(e,t,o)=>{const c={...e};if(o==="oneClickAuth"){const n=await st(c);c.appSecret=n.clientSecret}const s={config:{authType:"OAuth2",platform:c.platform},payload:{client_id:c.appId,client_secret:c.appSecret,code:t.code,grant_type:"no need",redirect_uri:c.redirectUri}},{data:h,status:u}=await x("authorize",s,void 0,"POST");u==="success"&&Y(O,{details:h,isModalOpen:!0,loading:!1,platform:"facebook",status:u})},nt=async(e,t,o)=>{let c={};const s=localStorage.getItem("__bitSocial_platform");s&&(c=JSON.parse(s),localStorage.removeItem("__bitSocial_platform")),(!c||!c.code||c.error)&&F.error({description:`${c.error?`Cause: ${c.error}.`:""} Please try again`,message:"Authorization failed"});const h=await it(e,c,o);return t(),h},rt=(e,t,o,c)=>{if(!e.platform||!e.appId||!e.redirectUri)throw new Error("Missing credentials");const{appId:s,platform:h,redirectUri:u}=e,n=c==="oneClickAuth"?K.REDIRECT_URL:u,r="pages_show_list,pages_read_engagement,pages_manage_metadata,pages_manage_posts,business_management",d=new URL("https://www.facebook.com/dialog/oauth");d.searchParams.append("scope",r),d.searchParams.append("client_id",s),d.searchParams.append("redirect_uri",n),d.searchParams.append("state",ot+"#/accounts/auth/response"),xe(d,h,o,e,t,c,nt)};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const lt=`${K.CLIENT_SECRET_URL}`,Pe=`${K.REDIRECT_URL}`,{baseAuthStateURL:ht}=M(_),ut=async(e,t)=>{const o={config:{authType:"OAuth2",platform:e.platform},payload:{client_id:e.appId,client_secret:e.appSecret,code:t.code,grant_type:"null",redirect_uri:e.redirectUri}},{data:c,status:s}=await x("authorize",o,void 0,"POST");s==="success"&&Y(O,{...{isModalOpen:!0,loading:!1,platform:"linkedin",status:s},details:c})},dt=async e=>{const t={client_id:e.appId,platform:e.platform},o={body:JSON.stringify(t),headers:{"Content-Type":"application/json"},method:"POST"};return fetch(lt,o).then(c=>c.json())},pt=async(e,t,o)=>{let c={};const s=localStorage.getItem("__bitSocial_platform"),h={...e};if(s&&(c=JSON.parse(s),localStorage.removeItem("__bitSocial_platform")),!c.code){F.error({description:`${c.error?`Cause: ${c.error}.`:""} Please try again`,message:"Authorization failed"});return}if(o==="oneClickAuth"){const n=await dt(e);(!n||!n.clientSecret)&&F.error({description:`Cause: ${n.message}. Please try again`,message:"Authorization failed"}),h.appSecret=n.clientSecret.toString(),h.redirectUri=Pe}const u=await ut(h,c);return t(),u},gt=(e,t,o,c)=>{if(!e.platform||!e.appId||!e.redirectUri)throw new Error("Missing credentials");const{appId:s,platform:h,redirectUri:u}=e,n=c==="oneClickAuth"?Pe:u,r="openid profile email w_member_social r_organization_admin w_organization_social rw_organization_admin",d=new URL("https://www.linkedin.com/oauth/v2/authorization");d.searchParams.append("scope",r),d.searchParams.append("client_id",s),d.searchParams.append("response_type","code"),d.searchParams.append("redirect_uri",n),d.searchParams.append("state",ht+"#/accounts/auth/response"),xe(d,h,o,e,t,c,pt)};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};function mt(e){switch(e){case"facebook":return rt;case"linkedin":return gt}}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const{baseAuthStateURL:Et}=M(_);globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const{baseAuthStateURL:Dt}=M(_);globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const{baseAuthStateURL:Kt}=M(_);globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const{baseAuthStateURL:Gt}=M(_);globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const{baseAuthStateURL:Ht}=M(_);globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const{baseAuthStateURL:Yt}=M(_);globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const{baseAuthStateURL:Qt}=M(_);globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const{baseAuthStateURL:Jt}=M(_);globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const{baseAuthStateURL:Wt}=M(_);globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};function Ie({authType:e="oneClickAuth",clientId:t,closeConnectModal:o,handleAuthCallback:c,isConnectLoading:s,platform:h,platformCredentialData:u,setCustomModalOpen:n}){const r=ve(Se),d=mt;return a(y,{block:!0,disabled:!t,loading:s,onClick:()=>{const C=d(h,u.apiVersion);if(ae(h)){r(!0);return}n&&n(!1),C&&C(u,c,o,e)},size:"small",type:"primary",children:i("Connect")})}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const{Text:ft}=m;var Ct={name:"3s4yqf",styles:"width:400px"};function bt({closeConnectModal:e,credential:t,handleAuthCallback:o,handleDelete:c,isDeleteLoading:s,name:h,platform:u,setCustomModalOpen:n}){const r={apiVersion:t.apiVersion??void 0,appId:t.appKey,appSecret:t.appSecret,platform:u,redirectUri:t.redirectUri};return a(J,{css:Ct,size:"small",children:l(Z,{align:"middle",justify:"space-between",children:[a(ft,{className:"text-capitalize",ellipsis:!0,strong:!0,style:{width:"200px"},children:h}),l(S,{children:[a(Ie,{authType:"customAuth",clientId:t.appKey,closeConnectModal:e,handleAuthCallback:o,platform:u,platformCredentialData:r,setCustomModalOpen:n}),a($e,{cancelText:i("No"),description:i("Are you sure to delete this app?"),okButtonProps:{danger:!0,loading:s},okText:i("Yes, Delete"),onConfirm:c,placement:"bottomRight",title:i("Delete the app"),children:a(y,{danger:!0,icon:a(Fe,{}),type:"text"})})]})]})})}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const{Text:V,Title:yt}=m,be=(e,t)=>({apiVersion:["twitter"],appName:["twitter","tumblr"]})[t].includes(e);var At={name:"11vupei",styles:"border-right:1px solid #B9B9B9"};function wt({closeConnectModal:e,handleAuthCallback:t,platform:o,setCustomModalOpen:c}){var $,re,le;const{apiURL:s,siteUrl:h}=Q(_),u=`${s.base}/redirect`,n=h,[r]=g.useForm(),[d,f]=I.useState({}),{createCustomApp:C,isLoadingCreateCustomApp:j}=et(),{deleteCustomApp:E,isLoadingDeleteCustomApp:p}=at(),{customApps:A}=tt(o),T=I.useRef(null),L=k=>{try{navigator.clipboard.writeText(k),F.success({message:"Copied!"})}catch{T.current!=null&&(T.current.select(),document.execCommand("copy"),T.current.blur())}},z=k=>{r.setFieldsValue({apiVersion:k})},N=[{label:"v1.1 (media supported)",value:"1.1"},{label:"v2.0 (media unsupported)",value:"2"}],w=async k=>{const ze={...k,platform:o},B=await C(ze);(B==null?void 0:B.code)==="SUCCESS"?(r.resetFields(),F.success({description:B.data.message,message:"App successfully added!"})):(B.data.errorField&&f(B.data.errorField),F.error({description:B.data.message,message:"App add failed"}))},G=k=>{E(k)};return l(Z,{className:"mt-4",gutter:[48,0],justify:"center",children:[a(b,{css:At,span:12,children:l(g,{form:r,initialValues:{redirectUri:u},layout:"vertical",onFinish:w,children:[a(g.Item,{label:a(V,{strong:!0,children:i("Homepage URI")}),name:"homepageUri",rules:[{message:"Please enter homepage url"}],children:l(S.Compact,{className:"w-100",children:[a(P,{defaultValue:`${n}`,ref:T,style:{width:"calc(100% - 32px)"}}),a(y,{icon:a(ue,{size:12}),onClick:()=>L(n),title:i("Click to copy")})]})}),a(g.Item,{label:a(V,{strong:!0,children:i("Redirect URI")}),name:"redirectUri",rules:[{message:"Please enter redirect url",required:!0}],children:l(S.Compact,{className:"w-100",children:[a(P,{defaultValue:`${u}`,ref:T,style:{width:"calc(100% - 32px)"}}),a(y,{icon:a(ue,{size:12}),onClick:()=>L(u),title:i("Click to copy")})]})}),be(o,"apiVersion")?a(g.Item,{label:a(V,{strong:!0,children:i("Api Version")}),name:"apiVersion",rules:[{message:"Please select an API version",required:!0}],children:a(_e,{onChange:z,options:N})}):"",be(o,"appName")?l(g.Item,{label:a(V,{strong:!0,children:i("App Name")}),name:"appName",rules:[{message:"Please enter your app name",required:!0}],children:[a(P,{}),d.appName&&a(m.Text,{type:"danger",children:($=d.appName)==null?void 0:$[0]})]}):"",a(S,{className:"pb-2",children:a(Ze,{platform:o})}),l(g.Item,{label:a(V,{strong:!0,children:i("App Key or Client ID")}),name:"appKey",rules:[{message:"Please enter your app key",required:!0}],children:[a(P,{}),d.appKey&&a(m.Text,{type:"danger",children:(re=d.appKey)==null?void 0:re[0]})]}),l(g.Item,{label:a(V,{strong:!0,children:i("App Secret or Client Secret")}),name:"appSecret",rules:[{message:"Please enter your app secret",required:!0}],children:[a(P,{}),d.appSecret&&a(m.Text,{type:"danger",children:(le=d.appSecret)==null?void 0:le[0]})]}),a(g.Item,{children:a(y,{className:"w-100",loading:j,onClick:()=>{r.submit()},size:"large",type:"primary",children:i("Add")})})]},o)}),l(b,{span:12,children:[a(yt,{level:5,children:i("Connected Apps")}),a(S,{direction:"vertical",children:A&&A.length?A.map(k=>a(bt,{appId:k.id,closeConnectModal:e,credential:k.credential,handleAuthCallback:t,handleDelete:()=>G(k.id),isDeleteLoading:p,name:k.name,platform:o,setCustomModalOpen:c},k.id)):a(V,{children:i("No App Found")})})]})]})}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const Tt=async(e,t,o)=>{const{id:c,token:s,type:h}=e;Y(O,{isModalOpen:!0,loading:!0}),t(),o();const n={config:{authType:"Token",platform:"line"},payload:{id:c,token:s,type:h}},{data:r,status:d}=await x("authorize",n,void 0,"POST"),f={isModalOpen:!0,loading:!1,platform:"line",status:d};d==="success"&&Y(O,{...f,details:r}),d==="error"&&"message"in r&&typeof r.message=="string"&&Y(O,{...f,message:r.message})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const{Link:ye,Text:H}=m;function kt({closeConnectModal:e,handleAuthCallback:t,platform:o}){const[c]=g.useForm(),[s,h]=I.useState("group"),u=async n=>{Tt(n,t,e)};return I.useEffect(()=>{c.setFieldsValue({type:s})},[s,c]),l(g,{form:c,initialValues:{type:"group"},layout:"vertical",onFinish:u,children:[a(g.Item,{label:a(H,{strong:!0,children:i("Type")}),name:"type",children:a(_e,{onChange:n=>h(n),options:[{label:i("Group"),value:"group"},{label:i("User"),value:"user"}]})}),a(g.Item,{extra:l(H,{type:"secondary",children:[R(i("Enter the ID of the target recipient. Use a %s Id value returned in a"),s)," ",l(ye,{href:"https://developers.line.biz/en/reference/messaging-api/#common-properties",rel:"noopener noreferrer nofollow",strong:!0,style:{whiteSpace:"nowrap"},target:"_blank",children:[i("webhook event object"),a(te,{size:12,style:{transform:"translateY(-2px)"}})]})]}),htmlFor:"id",label:a(H,{className:"capitalize",strong:!0,children:R(i("%s Id"),s)}),name:"id",rules:[{message:R("Please enter your %s id",s),required:!0}],children:a(P,{id:"id",name:"id"})}),a(g.Item,{extra:l(H,{type:"secondary",children:[i("To get token, Visit "),l(ye,{href:"https://developers.line.biz/console/",rel:"noopener noreferrer nofollow",strong:!0,style:{whiteSpace:"nowrap"},target:"_blank",children:[i("developer console"),a(te,{size:12,style:{transform:"translateY(-2px)"}})]})]}),htmlFor:"token",label:a(H,{strong:!0,children:i("Token")}),name:"token",rules:[{message:"Please enter your channel access token",required:!0}],children:a(P,{id:"token",name:"token"})}),a(g.Item,{children:a(y,{className:"w-100 capitalize",onClick:()=>c.submit(),size:"large",type:"primary",children:R(i("Connect %s"),o)})})]},o)}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};function vt({platform:e}){switch(e){case"bluesky":return a(Me,{message:"If 2FA is enable, you must use an App Password in the password field instead of your regular password.",showIcon:!0,type:"info"});default:return""}}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const{Text:Ae}=m;function St({closeConnectModal:e,handleAuthCallback:t,platform:o}){const[c]=g.useForm();return l(g,{form:c,layout:"vertical",onFinish:async h=>{},children:[a(g.Item,{label:a(Ae,{strong:!0,children:i("Username or Email")}),name:"id",rules:[{message:"Please enter your username or email",required:!0}],children:a(P,{})}),a(g.Item,{label:a(Ae,{strong:!0,children:i("Password")}),name:"password",rules:[{message:"Please enter your password",required:!0}],children:a(P,{})}),a(g.Item,{children:a(vt,{platform:o})}),a(g.Item,{children:a(y,{className:"w-100",onClick:()=>{c.submit()},size:"large",type:"primary",children:R(i("Connect %s "),o)})})]},o)}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const{Text:jt}=m;function Lt({closeConnectModal:e,handleAuthCallback:t,platform:o}){const[c]=g.useForm();return l(g,{form:c,layout:"vertical",onFinish:async h=>{},children:[a(g.Item,{label:a(jt,{strong:!0,children:i("Bot Token")}),name:"token",rules:[{message:"Please enter your bot token",required:!0}],children:a(P,{})}),a(g.Item,{children:a(y,{className:"w-100",onClick:()=>{c.submit()},size:"large",type:"primary",children:R(i("Connect %s "),o)})})]},o)}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};function Mt({closeConnectModal:e,currentConnectType:t,handleAuthCallback:o,platform:c,setCustomModalOpen:s}){switch(t){case"custom":return a(wt,{closeConnectModal:e,handleAuthCallback:o,platform:c,setCustomModalOpen:s});case"login":switch(c){case"bluesky":return a(St,{closeConnectModal:e,handleAuthCallback:o,platform:c});case"line":return a(kt,{closeConnectModal:e,handleAuthCallback:o,platform:c});case"telegram":return a(Lt,{closeConnectModal:e,handleAuthCallback:o,platform:c})}}}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const _t=`${K.REDIRECT_URL}`,{Title:we}=m,xt={custom:i("Connect Custom %s App"),login:i("%s"),oneClick:i("Connect %s")};function v({clientId:e,closeConnectModal:t,isConnectLoading:o,name:c,platform:s,setAccountModal:h,types:u}){const{refetchAccounts:n}=qe(),[r,d]=Te({}),f=r.get("value")||"all",[C,j]=I.useState(),[E,p]=I.useState(!1),{token:A}=je.useToken(),T=ve(Se),{isProClient:L}=Q(ie),z=()=>{p(!1)},N=$=>{if(j($),ae(s)&&!L){T(!0);return}t(),p(!0)},w=()=>{d($=>($.set("type","platform"),$.set("value",String(f)),$)),n()},G=()=>{z(),h(!0)};return a(J,{style:{borderColor:A.colorBorder,height:"100%"},children:l(D,{gap:14,vertical:!0,children:[l(S,{align:"center",children:[a(ce,{name:s,size:30,style:{flexShrink:0}}),a(we,{className:"text-capitalize",level:5,style:{marginBottom:0},children:c||ne[s].name}),ae(s)&&!L&&a(ke,{color:"#ff8609",size:20})]}),l(S,{size:0,children:[a(me,{platform:s}),a(Ce,{platform:s})]}),l(S,{direction:"vertical",size:"small",children:[u.includes("custom")&&a(y,{block:!0,onClick:()=>N("custom"),size:"small",style:{borderColor:A.colorPrimary},children:i("Custom App")}),u.includes("login")&&a(y,{block:!0,onClick:()=>N("login"),size:"small",type:"primary",children:i("Login")}),u.includes("oneClick")&&e&&a(Ie,{clientId:e,closeConnectModal:t,handleAuthCallback:w,isConnectLoading:o,platform:s,platformCredentialData:{appId:e,appSecret:"",platform:s,redirectUri:_t}})]}),C&&a(se,{centered:!0,footer:!1,onCancel:()=>p(!1),onOk:z,open:E,title:a("div",{children:l(D,{align:"center",gap:10,children:[a(y,{icon:a(Ne,{size:24}),onClick:G,title:i("Back"),type:"text"}),a(ce,{name:s,size:34}),a(we,{className:"text-capitalize",level:5,style:{marginBottom:0},children:R(i(xt[C]),s)}),a(me,{platform:s}),a(Ce,{platform:s})]})}),width:900,children:a(Mt,{closeConnectModal:t,currentConnectType:C,handleAuthCallback:w,platform:s,setCustomModalOpen:p})},s)]})})}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};function Xt({btnType:e="default"}){const{clientIds:t,isLoadingClientIds:o}=Ge(),{token:c}=je.useToken(),{isDarkTheme:s}=Q(ie),{isModalOpen:h}=Q(O),[u,n]=I.useState(!1),r=()=>{const f=localStorage.getItem("__bitSocial_platform_interval");f&&(clearInterval(Number(f)),localStorage.removeItem("__bitSocial_platform_interval")),n(!1)},d=()=>{n(!0)};return l("div",{children:[e==="default"?a(y,{icon:a(de,{size:18}),onClick:d,size:"small",type:"primary",children:i("Connect Account")}):a(y,{"aria-label":i("Connect Account"),icon:a(de,{size:30}),onClick:d,style:{alignItems:"center",border:`2px solid ${c.colorPrimary}`,color:s?c.colorTextBase:c.colorPrimary,display:"flex",fontSize:"17px",fontWeight:600,height:"100%",justifyContent:"center",minHeight:"110px",width:"100%"},type:"text",children:i("Connect Account")}),a(se,{centered:!0,footer:!1,onCancel:r,open:u,style:{padding:"20px"},title:i("Connect Account"),width:1e3,children:l(Z,{className:"p-2",gutter:[12,12],children:[a(b,{md:6,sm:12,xs:24,children:a(v,{clientId:t==null?void 0:t.facebook.id,closeConnectModal:r,isConnectLoading:o,platform:"facebook",setAccountModal:n,status:t==null?void 0:t.facebook.status,types:["oneClick","custom"]})}),a(b,{md:6,sm:12,xs:24,children:a(v,{clientId:t==null?void 0:t.linkedin.id,closeConnectModal:r,isConnectLoading:o,platform:"linkedin",setAccountModal:n,status:t==null?void 0:t.linkedin.status,types:["oneClick","custom"]})}),a(b,{md:6,sm:12,xs:24,children:a(v,{clientId:t==null?void 0:t.threads.id,closeConnectModal:r,isConnectLoading:o,platform:"threads",setAccountModal:n,status:t==null?void 0:t.threads.status,types:["oneClick","custom"]})}),a(b,{md:6,sm:12,xs:24,children:a(v,{clientId:t==null?void 0:t.googleBusinessProfile.id,closeConnectModal:r,isConnectLoading:o,name:"Google Business",platform:"googleBusinessProfile",setAccountModal:n,status:t==null?void 0:t.googleBusinessProfile.status,types:["oneClick","custom"]})}),a(b,{md:6,sm:12,xs:24,children:a(v,{clientId:t==null?void 0:t.pinterest.id,closeConnectModal:r,isConnectLoading:o,platform:"pinterest",setAccountModal:n,status:t==null?void 0:t.pinterest.status,types:["oneClick","custom"]})}),a(b,{md:6,sm:12,xs:24,children:a(v,{clientId:t==null?void 0:t.discord.id,closeConnectModal:r,isConnectLoading:o,platform:"discord",setAccountModal:n,status:t==null?void 0:t.discord.status,types:["oneClick","custom"]})}),a(b,{md:6,sm:12,xs:24,children:a(v,{clientId:t==null?void 0:t.tumblr.id,closeConnectModal:r,isConnectLoading:o,platform:"tumblr",setAccountModal:n,status:t==null?void 0:t.tumblr.status,types:["oneClick","custom"]})}),a(b,{md:6,sm:12,xs:24,children:a(v,{clientId:t==null?void 0:t.instagram.id,closeConnectModal:r,isConnectLoading:o,platform:"instagram",setAccountModal:n,status:t==null?void 0:t.instagram.status,types:["oneClick","custom"]})}),a(b,{md:6,sm:12,xs:24,children:a(v,{closeConnectModal:r,name:"TikTok",platform:"tiktok",setAccountModal:n,types:["custom"]})}),a(b,{md:6,sm:12,xs:24,children:a(v,{closeConnectModal:r,name:"X (Twitter)",platform:"twitter",setAccountModal:n,types:["custom"]})}),a(b,{md:6,sm:12,xs:24,children:a(v,{closeConnectModal:r,name:"Bluesky",platform:"bluesky",setAccountModal:n,status:0,types:["login"]})}),a(b,{md:6,sm:12,xs:24,children:a(v,{closeConnectModal:r,name:"Line",platform:"line",setAccountModal:n,status:0,types:["login"]})}),a(b,{md:6,sm:12,xs:24,children:a(v,{closeConnectModal:r,name:"Telegram",platform:"telegram",setAccountModal:n,status:0,types:["login"]})})]})}),h&&a(Ke,{})]})}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};function Zt(){const{data:e,isLoading:t,refetch:o}=W({queryFn:async()=>x("pro_groups",void 0,void 0,"GET"),queryKey:["groups"]});return{groups:(e==null?void 0:e.data)||[],isLoadingGroups:t,refetchGroups:o}}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const ea=e=>e.accounts.map(o=>Number(o.id)),ta=(e,t,o)=>{const c=t.find(s=>s.name.toLowerCase()===e.toLowerCase());return!!c&&c.id!==o};export{Xt as C,Zt as a,ea as g,ta as i,qe as u};
